!function(t){var e={};function s(i){if(e[i])return e[i].exports;var n=e[i]={i:i,l:!1,exports:{}};return t[i].call(n.exports,n,n.exports,s),n.l=!0,n.exports}s.m=t,s.c=e,s.d=function(t,e,i){s.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},s.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(t,e){if(1&e&&(t=s(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(s.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)s.d(i,n,function(e){return t[e]}.bind(null,n));return i},s.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="",s(s.s=3)}([function(t,e,s){t.exports=s.p+"61dd95180de5ed97d4a74e36347ea6b5.png"},function(t,e,s){t.exports=s.p+"7ef082c597a28c2773e94712e0ae8fd8.png"},function(t,e,s){!function(){function e(t,e){document.addEventListener?t.addEventListener("scroll",e,!1):t.attachEvent("scroll",e)}function s(t){this.a=document.createElement("div"),this.a.setAttribute("aria-hidden","true"),this.a.appendChild(document.createTextNode(t)),this.b=document.createElement("span"),this.c=document.createElement("span"),this.h=document.createElement("span"),this.f=document.createElement("span"),this.g=-1,this.b.style.cssText="max-width:none;display:inline-block;position:absolute;height:100%;width:100%;overflow:scroll;font-size:16px;",this.c.style.cssText="max-width:none;display:inline-block;position:absolute;height:100%;width:100%;overflow:scroll;font-size:16px;",this.f.style.cssText="max-width:none;display:inline-block;position:absolute;height:100%;width:100%;overflow:scroll;font-size:16px;",this.h.style.cssText="display:inline-block;width:200%;height:200%;font-size:16px;max-width:none;",this.b.appendChild(this.h),this.c.appendChild(this.f),this.a.appendChild(this.b),this.a.appendChild(this.c)}function i(t,e){t.a.style.cssText="max-width:none;min-width:20px;min-height:20px;display:inline-block;overflow:hidden;position:absolute;width:auto;margin:0;padding:0;top:-999px;white-space:nowrap;font-synthesis:none;font:"+e+";"}function n(t){var e=t.a.offsetWidth,s=e+100;return t.f.style.width=s+"px",t.c.scrollLeft=s,t.b.scrollLeft=t.b.scrollWidth+100,t.g!==e&&(t.g=e,!0)}function a(t,s){function i(){var t=a;n(t)&&t.a.parentNode&&s(t.g)}var a=t;e(t.b,i),e(t.c,i),n(t)}function r(t,e){var s=e||{};this.family=t,this.style=s.style||"normal",this.weight=s.weight||"normal",this.stretch=s.stretch||"normal"}var o=null,h=null,c=null,l=null;function d(){return null===l&&(l=!!document.fonts),l}function u(){if(null===c){var t=document.createElement("div");try{t.style.font="condensed 100px sans-serif"}catch(t){}c=""!==t.style.font}return c}function _(t,e){return[t.style,t.weight,u()?t.stretch:"","100px",e].join(" ")}r.prototype.load=function(t,e){var n=this,r=t||"BESbswy",c=0,l=e||3e3,u=(new Date).getTime();return new Promise((function(t,e){if(d()&&!function(){if(null===h)if(d()&&/Apple/.test(window.navigator.vendor)){var t=/AppleWebKit\/([0-9]+)(?:\.([0-9]+))(?:\.([0-9]+))/.exec(window.navigator.userAgent);h=!!t&&603>parseInt(t[1],10)}else h=!1;return h}()){var m=new Promise((function(t,e){!function s(){(new Date).getTime()-u>=l?e(Error(l+"ms timeout exceeded")):document.fonts.load(_(n,'"'+n.family+'"'),r).then((function(e){1<=e.length?t():setTimeout(s,25)}),e)}()})),p=new Promise((function(t,e){c=setTimeout((function(){e(Error(l+"ms timeout exceeded"))}),l)}));Promise.race([p,m]).then((function(){clearTimeout(c),t(n)}),e)}else!function(t){document.body?t():document.addEventListener?document.addEventListener("DOMContentLoaded",(function e(){document.removeEventListener("DOMContentLoaded",e),t()})):document.attachEvent("onreadystatechange",(function e(){"interactive"!=document.readyState&&"complete"!=document.readyState||(document.detachEvent("onreadystatechange",e),t())}))}((function(){function h(){var e;(e=-1!=g&&-1!=f||-1!=g&&-1!=w||-1!=f&&-1!=w)&&((e=g!=f&&g!=w&&f!=w)||(null===o&&(e=/AppleWebKit\/([0-9]+)(?:\.([0-9]+))/.exec(window.navigator.userAgent),o=!!e&&(536>parseInt(e[1],10)||536===parseInt(e[1],10)&&11>=parseInt(e[2],10))),e=o&&(g==v&&f==v&&w==v||g==y&&f==y&&w==y||g==D&&f==D&&w==D)),e=!e),e&&(b.parentNode&&b.parentNode.removeChild(b),clearTimeout(c),t(n))}var d=new s(r),m=new s(r),p=new s(r),g=-1,f=-1,w=-1,v=-1,y=-1,D=-1,b=document.createElement("div");b.dir="ltr",i(d,_(n,"sans-serif")),i(m,_(n,"serif")),i(p,_(n,"monospace")),b.appendChild(d.a),b.appendChild(m.a),b.appendChild(p.a),document.body.appendChild(b),v=d.a.offsetWidth,y=m.a.offsetWidth,D=p.a.offsetWidth,function t(){if((new Date).getTime()-u>=l)b.parentNode&&b.parentNode.removeChild(b),e(Error(l+"ms timeout exceeded"));else{var s=document.hidden;!0!==s&&void 0!==s||(g=d.a.offsetWidth,f=m.a.offsetWidth,w=p.a.offsetWidth,h()),c=setTimeout(t,50)}}(),a(d,(function(t){g=t,h()})),i(d,_(n,'"'+n.family+'",sans-serif')),a(m,(function(t){f=t,h()})),i(m,_(n,'"'+n.family+'",serif')),a(p,(function(t){w=t,h()})),i(p,_(n,'"'+n.family+'",monospace'))}))}))},t.exports=r}()},function(t,e,s){"use strict";s.r(e);class i{constructor(t,e){if(this._alwaysCheckForUpdates=!1,this._position=t,this._bounds=e,this.position&&(this._position.transform=this),this.bounds&&(this._bounds.transform=this),!this.bounds&&this.position)throw new Error("A Transform with a non-null Position must have a non-null Bounds")}get gameObject(){return this._gameObject}set gameObject(t){this._gameObject=t}get position(){return this._position}get bounds(){return this._bounds}get alwaysCheckForUpdates(){return this._alwaysCheckForUpdates}set alwaysCheckForUpdates(t){this._alwaysCheckForUpdates=t}get positioningDirty(){return this._positioningDirty}positioningIsDirty(){this._positioningDirty=!0}get parent(){return this.gameObject&&this.gameObject.parent?this.gameObject.parent.transform:null}hasPosition(){return null!==this.position}update(){(this._positioningDirty||this._alwaysCheckForUpdates)&&this._checkForUpdatedTranslationsOrDimensions()}_checkForUpdatedTranslationsOrDimensions(){this.position&&this.position.checkForUpdatedTranslations(),this.bounds&&this.bounds.checkForUpdatedDimensions(),this._positioningDirty=!1}recalculate(t){if(this._position&&this._position.setCacheDirty(),this._bounds&&(this._bounds.dirty=!0),0===this.gameObject.children.length)t||this.gameObject.requestDraw();else for(let e=0,s=this.gameObject.children.length;e<s;e++)this.gameObject.children[e].transform&&this.gameObject.children[e].transform.recalculate(t)}containsPoint(t,e){let s=this.position.x(),i=this.position.y();return t>=s&&e>=i&&t<=s+this.bounds.width()&&e<=i+this.bounds.height()}destroy(){this.bounds&&this.bounds.destroy(),this.position&&this.position.destroy()}static overlaps(t,e){let s=0,i=0,n=0,a=0;t.position&&(s=t.position.x(),i=t.position.y()),e.position&&(n=e.position.x(),a=e.position.y());let r=!1,o=!1;return s>=n&&s<=n+e.bounds.width()&&(r=!0),s<=n&&s+t.bounds.width()>=n&&(r=!0),i>=a&&i<=a+e.bounds.height()&&(o=!0),i<=a&&i+t.bounds.height()>=a&&(o=!0),r&&o}static contains(t,e){let s=t.position.x(),i=t.position.y(),n=e.position.x(),a=e.position.y(),r=!1,o=!1;return n>=s&&n+e.bounds.width()<=s+t.bounds.width()&&(r=!0),a>=i&&a+e.bounds.width()<=i+t.bounds.height()&&(o=!0),r&&o}}class n{constructor(t,e){this._x=t||0,this._y=e||0}get x(){return this._x}get y(){return this._y}get magnitude(){return Math.sqrt(this._x*this._x+this._y*this._y)}get isZero(){return 0===this.x&&0===this.y}static add(t,e){let s=t.x+e.x,i=t.y+e.y;return new n(s,i)}static minus(t,e){if(!e)return this.minus(new n(0,0),t);let s=t.x-e.x,i=t.y-e.y;return new n(s,i)}static multiply(t,e){return e instanceof n?new n(t.x*e.x,t.y*e.y):new n(t.x*e,t.y*e)}static dotProduct(t,e){return t.x*e.x+t.y*e.y}static divide(t,e){let s=t.x/e,i=t.y/e;return new n(s,i)}static crossProduct(t,e){return t.x*e.y-t.y*e.x}static equals(t,e){return t.x===e.x&&t.y===e.y}static distance(t,e){let s=t.x-e.x,i=t.y-e.y;return Math.sqrt(s*s+i*i)}rotate(t){let e=Math.cos(t)*this._x+-Math.sin(t)*this._y,s=Math.sin(t)*this._x+Math.cos(t)*this._y;return new n(e,s)}closestPoint(t){let e,s=void 0;return t.forEach(t=>{let i=n.minus(t,this).magnitude;(void 0===s||i<s)&&(s=i,e=t)}),e}get normalised(){return n.divide(this,this.magnitude)}static angleBetween(t,e){return Math.atan2(e.y,e.x)-Math.atan2(t.y,t.x)}projectionIn(t){return n.dotProduct(this,t.normalised)}static angleToUnitVector(t){return new n(Math.cos(t),Math.sin(t))}asAngle(){return Math.atan2(this.x,this.y)}}class a{constructor(t,e,s){this._x=0,this._y=0,this._anchorX=0,this._anchorY=0,this._updated=!1,t instanceof n?(this._x=t.x,this._y=t.y,e instanceof n&&(this.anchorX=e.x,this.anchorY=e.y)):("number"==typeof t&&"number"==typeof e&&(this._x=t,this._y=e),s&&(this.anchorX=s.x,this.anchorY=s.y))}get updated(){return this._updated}set updated(t){this._updated=t}markAsUpdated(){this._updated=!0}get innerX(){return this._x}set innerX(t){t!==this._x&&(this._x=t,this._updated=!0)}get innerY(){return this._y}set innerY(t){t!==this._y&&(this._y=t,this._updated=!0)}getOffsetX(t){return this._x}getOffsetY(t){return this._y}getAnchorOffsetX(t){return t.width()*this._anchorX}getAnchorOffsetY(t){return t.height()*this._anchorY}getOffsetXTopLeft(t){return this.getOffsetX(t)-this.getAnchorOffsetX(t)}getOffsetYTopLeft(t){return this.getOffsetY(t)-this.getAnchorOffsetY(t)}get anchorX(){return this._anchorX}get anchorY(){return this._anchorY}set anchorX(t){t!==this._anchorX&&(this._updated=!0),this._anchorX=t}set anchorY(t){t!==this._anchorY&&(this._updated=!0),this._anchorY=t}destroy(){}}class r extends a{constructor(t,e){e instanceof n?super(0,0,e):super(0,0),this._conditionalFunction=t,this.updateSpecial=!0}get previousAbsolutePosition(){return this._previousAbsolutePosition}getOffsetX(t){return this.absolutePosition(t).x}getOffsetY(t){return this.absolutePosition(t).y}absolutePosition(t){let e=void 0,s=void 0;return t.parentBounds&&(e=t.parentBounds.width(),s=t.parentBounds.height()),this._previousAbsolutePosition=this._conditionalFunction(t.transform,e,s),this._previousAbsolutePosition}absolutePositionDontUpdatePrevious(t){return this._conditionalFunction(t.transform,t.parentBounds.width(),t.parentBounds.height())}}class o{constructor(t,e){this._updated=!1,this._width=t,this._height=e}get updated(){return this._updated}set updated(t){this._updated=t}markAsUpdated(){this._updated=!0}get width(){return this._width}set width(t){t!==this.width&&(this.updated=!0),this._width=t}get height(){return this._height}set height(t){t!==this._height&&(this.updated=!0),this._height=t}pixelWidth(t){return this._width}pixelHeight(t){return this._height}physicalPixelWidth(t){return this.pixelWidth(t)*t.devicePixelRatio}physicalPixelHeight(t){return this.pixelHeight(t)*t.devicePixelRatio}get aspect(){return this.height/this.width}destroy(){}static add(t,e){return new o(t.width+e.width,t.height+e.height)}static equals(t,e){return t.width===e.width&&t.height===e.height}}class h extends o{constructor(t,e,s){super(t,e),s&&(this._referenceBounds=s,this._referenceBounds.onResize.push(this.markAsUpdated.bind(this),this))}pixelWidth(t){return this._referenceBounds?this._referenceBounds.calculating?this.width*this._referenceBounds.cachedWidth:this.width*this._referenceBounds.width():t?this.width*t.width():0}pixelHeight(t){return this._referenceBounds?this._referenceBounds.calculating?this.height*this._referenceBounds.cachedHeight:this.height*this._referenceBounds.height():t?this.height*t.height():0}destroy(){this._referenceBounds&&this._referenceBounds.onResize.unregister(this)}}class c{constructor(t,e){this.key=t,this.value=e}}class l{constructor(){this.entries=[]}get length(){return this.entries.length}push(t,e){this.entries.push(new c(t,e))}delete(t,e){let s=[];this.entries.forEach(i=>{i.key!==t?s.push(i):e&&i.value!==e&&s.push(i)}),this.entries=s}deleteValue(t){let e=[];this.entries.forEach(s=>{s.value!==t&&e.push(s)}),this.entries=e}clear(){this.entries=[]}forEach(t){this.entries.forEach(t)}}class d{constructor(){this._callbacks=new l}call(...t){for(let e=0,s=this._callbacks.entries.length;e<s;e++)this._callbacks.entries[e].value(...t)}push(t,e){return this._callbacks.push(e,t),this}unregister(t){this._callbacks.delete(t)}remove(t){this._callbacks.deleteValue(t)}removeAll(){this._callbacks.clear()}get length(){return this._callbacks.length}clone(){let t=new(0,Object.getPrototypeOf(this).constructor);for(let e=0,s=this._callbacks.entries.length;e<s;e++)t.push(this._callbacks.entries[e].value,this._callbacks.entries[e].key);return t}static link(t,e,s){t&&e&&t.push(e.call.bind(e),s)}}class u extends d{call(){for(let t=0,e=this._callbacks.entries.length;t<e;t++)this._callbacks.entries[t].value()}push(t,e){return super.push(t,e)}}class _ extends d{call(t){for(let e=0,s=this._callbacks.entries.length;e<s;e++)this._callbacks.entries[e].value(t)}push(t,e){return super.push(t,e)}}class m extends d{call(t,e){for(let s=0,i=this._callbacks.entries.length;s<i;s++)this._callbacks.entries[s].value(t,e)}push(t,e){return super.push(t,e)}}class p extends m{call(t,e){super.call(t,e)}push(t,e){return super.push(t,e)}}class g{constructor(...t){this._dimensions=[],this._referenceWidth=void 0,this._targetAspectRatio=void 0,this._minDimension=void 0,this._maxDimension=void 0,this._transform=null,this._cachedWidth=0,this._cachedHeight=0,this._onResize=new u,this._dirty=!0,this._calculating=!1,this._dimensions=t}get transform(){return this._transform}set transform(t){this._transform=t}get dirty(){return this._dirty}set dirty(t){this._dirty=t}get cachedWidth(){return this._cachedWidth}get cachedHeight(){return this._cachedHeight}get calculating(){return this._calculating}get onResize(){return this._onResize}get devicePixelRatio(){return window.devicePixelRatio}get parentBounds(){return this.transform&&this.transform.parent?this.transform.parent.bounds:null}get targetAspectRatio(){return this._targetAspectRatio}set targetAspectRatio(t){this._targetAspectRatio=t}get maxDimension(){return this._maxDimension}set maxDimension(t){this._maxDimension=t}get minDimension(){return this._minDimension}set minDimension(t){this._minDimension=t}static get fill(){return new g(new h(1,1))}get dimensions(){return this._dimensions}width(){return this.dirty?(this._updateCache(),this._cachedWidth):this._cachedWidth}height(){return this.dirty?(this._updateCache(),this._cachedHeight):this._cachedHeight}asDimension(){return new o(this.width(),this.height())}aspect(){return this.height()/this.width()}get referenceWidth(){return void 0!==this._referenceWidth?this._referenceWidth:this.parentBounds?this.parentBounds.referenceWidth:void 0}set referenceWidth(t){this._referenceWidth=t}get referenceHeight(){return void 0!==this._referenceWidth?this.referenceWidth*this.aspect():this.parentBounds?this.parentBounds.referenceHeight:void 0}get referenceScale(){return void 0!==this._referenceWidth?this.width()/this._referenceWidth:this.parentBounds?this.parentBounds.referenceScale:0}addDimension(t){return this._dimensions.push(t),this.transform.gameObject.created&&this.hasResizedAutoUpdate()&&this._onChange(),t}clearDimensions(){this._dimensions=[],this.hasResizedAutoUpdate()&&this._onChange()}hasResizedAutoUpdate(){if(this.dirty)return!0;let t=this._cachedWidth,e=this._cachedHeight;return this._calculateAndSetDimension()||this._cachedWidth!==t||this._cachedHeight!==e}checkForUpdatedDimensions(){let t,e=!1;for(let s=0,i=this._dimensions.length;s<i;s++){if(t=this._dimensions[s],t.updated){e=!0;break}if(t.updateSpecial&&t.hasChanged(this.parentBounds)){e=!0;break}}if(e){this._onChange();for(let t=0,e=this._dimensions.length;t<e;t++)this._dimensions[t].updated=!1}}destroy(){this.onResize.removeAll();for(let t=0,e=this._dimensions.length;t<e;t++)this._dimensions[t].destroy()}_onChange(){this.transform&&(this.transform.recalculate(),this.onResize.call())}_updateCache(){let t=this._calculateAndSetDimension();this.dirty=t,t&&this.transform.positioningIsDirty()}_calculateAndSetDimension(){this._calculating=!0;let t=!1,e=0,s=0;if(this.transform)for(let i=0,n=this._dimensions.length;i<n;i++){let n=this._dimensions[i].pixelWidth(this.parentBounds),a=this._dimensions[i].pixelHeight(this.parentBounds);void 0===n||void 0===a?t=!0:(e+=n,s+=a)}return this._limitAndSetDimension(e,s),this._calculating=!1,t}_limitAndSetDimension(t,e){this.minDimension&&(this.minDimension.pixelWidth(this.parentBounds)&&(t=Math.max(t,this.minDimension.pixelWidth(this.parentBounds))),this.minDimension.pixelHeight(this.parentBounds)&&(e=Math.max(e,this.minDimension.pixelHeight(this.parentBounds)))),this.maxDimension&&(this.maxDimension.pixelWidth(this.parentBounds)&&(t=Math.min(t,this.maxDimension.pixelWidth(this.parentBounds))),this.maxDimension.pixelHeight(this.parentBounds)&&(e=Math.min(e,this.maxDimension.pixelHeight(this.parentBounds)))),this.targetAspectRatio&&(e<t*this.targetAspectRatio?t=e*(1/this.targetAspectRatio):e=t*this.targetAspectRatio),this._cachedWidth=t,this._cachedHeight=e}}class f extends a{constructor(t,e,s,i){t instanceof n?e instanceof n?(super(t,e),s instanceof g&&(this._referenceBounds=s)):(super(t),e instanceof g&&(this._referenceBounds=e)):"number"==typeof t&&"number"==typeof e&&(s instanceof n?(super(t,e,s),i&&(this._referenceBounds=i)):(super(t,e),s instanceof g&&(this._referenceBounds=s))),this._referenceBounds&&this._referenceBounds.onResize.push(this.markAsUpdated.bind(this),this)}get referenceBounds(){return this._referenceBounds}getOffsetX(t){let e=0;return this._referenceBounds?e=this._referenceBounds.width():t.parentBounds&&(e=t.parentBounds.width()),this.innerX*e}getOffsetY(t){let e=0;return this._referenceBounds?e=this._referenceBounds.height():t.parentBounds&&(e=t.parentBounds.height()),this.innerY*e}destroy(){this._referenceBounds&&this._referenceBounds.onResize.unregister(this)}}class w{constructor(...t){this._transform=null,this._resetDrawPos=!1,this._cachedX=0,this._cachedY=0,this._cacheXDirty=!0,this._cacheYDirty=!0,this._rotation=0,this._translations=t}get transform(){return this._transform}set transform(t){this._transform=t}get resetDrawPos(){return this._resetDrawPos}set resetDrawPos(t){this._resetDrawPos=t}get translations(){return this._translations}point(){return new n(this.x(),this.y())}get rotation(){return this._rotation}set rotation(t){this._rotation=t}static get right(){return new w(new f(1,0,new n(1,0)))}static get bottom(){return new w(new f(0,1,new n(0,1)))}static get bottomRight(){return new w(new f(1,1,new n(1,1)))}static get bottomCentre(){return new w(new f(.5,1,new n(.5,1)))}static get centre(){return new w(new f(.5,.5,new n(.5,.5)))}static get centreX(){return new w(new f(.5,0,new n(.5,0)))}static get centreY(){return new w(new f(0,.5,new n(0,.5)))}static get centreRight(){return new w(new f(1,.5,new n(1,.5)))}addTranslation(t){let e=null;for(let s=0;s<this._translations.length;s++){let i=this._translations[s];if(i.constructor===t.constructor&&i.anchorX==t.anchorX&&i.anchorY==t.anchorY)if(i instanceof f){i.referenceBounds===t.referenceBounds&&(e=i,i.innerX=i.innerX+t.innerX,i.innerY=i.innerY+t.innerY)}else i instanceof r||(e=i,i.innerX=i.innerX+t.innerX,i.innerY=i.innerY+t.innerY)}return e||this._translations.push(t),this.transform.gameObject.created&&this.hasMoved()&&this._onChange(),e||t}clearTranslations(){this._translations=[],this.hasMoved()&&this._onChange()}x(){if(!this._cacheXDirty)return this._cachedX;let t=this._calculateOffsetX();return this._cacheXDirty=!1,this._cachedX=t,t}y(){if(!this._cacheYDirty)return this._cachedY;let t=this._calculateOffsetY();return this._cacheYDirty=!1,this._cachedY=t,t}setCacheDirty(){this._cacheXDirty=!0,this._cacheYDirty=!0}anchorX(t){return this.x()+this.transform.bounds.width()*t}anchorY(t){return this.y()+this.transform.bounds.height()*t}getAnchorPosition(t,e){if(t){let s=this.point();return t instanceof n?new n(s.x+this.transform.bounds.width()*t.x,s.y+this.transform.bounds.height()*t.y):new n(s.x+this.transform.bounds.width()*t,s.y+this.transform.bounds.height()*e)}return this.point()}checkForUpdatedTranslations(){let t,e=!1;for(let s=0,i=this._translations.length;s<i;s++){if(t=this._translations[s],t.updated){e=!0;break}if(t.updateSpecial&&(!t.previousAbsolutePosition||!n.equals(t.absolutePositionDontUpdatePrevious(this.transform.bounds),t.previousAbsolutePosition))){e=!0;break}}e&&(this._onChange(),this._translations.forEach(t=>t.updated=!1))}hasMoved(){if(this._cacheXDirty||this._cacheYDirty)return!0;let t=this._calculateOffsetX(),e=this._calculateOffsetY();return t!==this._cachedX||e!==this._cachedY}hasMovedAutoUpdate(){if(this._cacheXDirty||this._cacheYDirty)return!0;let t=this._cachedX,e=this._cachedY;return this._cachedX=this._calculateOffsetX(),this._cachedY=this._calculateOffsetY(),t!==this._cachedX||e!==this._cachedY}destroy(){for(let t=0,e=this._translations.length;t<e;t++)this._translations[t].destroy()}_onChange(){this.transform&&this.transform.recalculate()}_calculateOffsetX(){let t=0;for(let e=0;e<this._translations.length;e++)this.transform&&(t+=this._translations[e].getOffsetXTopLeft(this.transform.bounds));return this.transform&&this.transform.parent&&this.transform.parent.hasPosition()&&(t+=this.transform.parent.position.x()),t}_calculateOffsetY(){let t=0;for(let e=0;e<this._translations.length;e++)this.transform&&(t+=this._translations[e].getOffsetYTopLeft(this.transform.bounds));return this.transform&&this.transform.parent&&this.transform.parent.hasPosition()&&(t+=this.transform.parent.position.y()),t}}function v(t,e){y(t,e,t.length-1),t.length=t.length-1}function y(t,e,s){var i=t[e];t[e]=t[s],t[s]=i}class D{constructor(t,e){this.typeName="GameObject",this._children=[],this._assets=[],this._parent=null,this._created=!1,this._runLoad=!1,this._active=!0,this._interactable=!0,this._ranBegin=!1,this._visible=!0,this._opacity=1,this._cullIfOutOfBounds=!1,this._precreate=!1,this._transform=t instanceof w?new i(t,e):t,this._transform&&(this._transform.gameObject=this)}get parent(){return this._parent}set parent(t){this._parent=t}get transform(){return this._transform}get loaded(){if(!this.runLoad)return!1;let t=!0;for(let e=0,s=this._assets.length;e<s;e++)if(!this._assets[e].loaded){t=!1;break}return t}get subtreeLoaded(){if(!this.loaded)return!1;let t=!0;for(let e=0,s=this._children.length;e<s;e++)if(!this._children[e].subtreeLoaded){t=!1;break}return t}get runLoad(){return this._runLoad}get created(){return this._created}get assets(){return this._assets}get children(){return this._children}set active(t){this._active=t}get active(){return this._active}set interactable(t){this._interactable=t}get interactable(){return!!this._interactable&&(!this.parent||this.parent.interactable)}set visible(t){this._visible!==t&&(t||this.requestDraw(),this._visible=t,t&&this.requestDraw())}get visible(){return this._visible}get opacity(){return this._opacity}set opacity(t){this._opacity=t}get precreate(){return this._precreate}set precreate(t){this._precreate=t}get cullIfOutOfBounds(){return this._cullIfOutOfBounds}set cullIfOutOfBounds(t){this._cullIfOutOfBounds=t}addChild(t){if(t.parent)throw new Error("Adding child to GameObject, but child already has parent! GameObjects must not appear more than once in the GameObject tree. If you want to move a GameObject, first de-parent it.");return t.parent=this,this._children.push(t),t}getAsset(t){for(let e=0,s=this._assets.length;e<s;e++)if(this._assets[e].filename===t)return this.assets[e].asset;throw new Error("No asset found with that name on GameObject")}doLoad(t){this._runLoad||(this._runLoad=this.load(t));for(let e=0,s=this._children.length;e<s;e++)this._children[e].doLoad(t)}load(t){return!0}addAsset(t){if(null===t)return null;let e=!1;for(let s=0,i=this.assets.length;s<i;s++)this._assets[s].filename===t.filename&&(e=!0);return e?null:(this.assets.push(t),t)}doCreate(t,e,s,i){if(this._runLoad||this.doLoad(e),this.loaded){let n=!1;this.created||(n=!0,this.create(t,s,i));for(let n=0,a=this._children.length;n<a;n++)this._children[n].doCreate(t,e,s,i);this._created=!0,n&&this.afterCreate(),this.requestDraw()}}create(t,e,s){}afterCreate(){}doBegin(t,e,s,i){this._active?this._created?this._runBegin(t,e,s,i):(this.doCreate(t,e,s,i),this._created&&this._runBegin(t,e,s,i)):this._precreate&&!this._created&&this.doCreate(t,e,s,i)}_runBegin(t,e,s,i){this._ranBegin=!0;for(let n=this._children.length-1;n>=0;n--)this._children[n]&&this._children[n].doBegin(t,e,s,i);this.begin(t,s,i)}begin(t,e,s){}doUpdate(t){if(this._transform&&this._transform.update(),this._ranBegin){for(let e=this._children.length-1;e>=0;e--)this._children[e]&&this._children[e].doUpdate(t);this.update(t)}}update(t){}doDraw(t){if(this._created&&this._visible&&this._transform&&this._opacity>0&&this._transform.hasPosition()){let e=!1;if(this._transform.position.rotation%2*Math.PI!=0){e=!0;let s=this._transform.position.anchorX(.5)-t.x(),i=this._transform.position.anchorY(.5)-t.y();t.context2D.save(),t.context2D.translate(s,i),t.context2D.rotate(this._transform.position.rotation),t.context2D.translate(-s,-i)}let s=0;t.context2D&&(s=this._setDrawingOpacity(t.context2D)),this.draw(t);for(let e=0,s=this._children.length;e<s;e++)this._children[e].doDraw(t);t.context2D&&void 0!==s&&(t.context2D.globalAlpha=s),e&&t.context2D.restore()}}_setDrawingOpacity(t){if(1!==this._opacity){let e=t.globalAlpha;return t.globalAlpha=t.globalAlpha*this._opacity,e}}draw(t){}doEnd(t){if(this._ranBegin){for(let e=this._children.length-1;e>=0;e--)this._children[e]&&this._children[e].doEnd(t);this._ranBegin=!1,this.end(t)}}requestDraw(t){!this._visible||!this._parent||this._cullIfOutOfBounds&&this.isDrawCulled()||this._parent.requestDraw(!0)}isDrawCulled(){return!!(this._transform&&this._parent&&this._parent.created&&this._parent.transform)&&!i.overlaps(this._transform,this._parent.transform)}requestRemoval(){this._parent.removeChild(this)}removeChild(t){this.deparent(t),t.doDestroy()}deparent(t){let e=this._children.indexOf(t);-1!==e&&v(this._children,e)}doDestroy(){for(let t=0,e=this._children.length;t<e;t++)this._children[t].doDestroy();this._transform&&this._transform.destroy(),this.created&&this.destroy()}end(t){}destroy(){}}class b{constructor(t,e,s,i,n,a){"string"==typeof t?(this.colour=t,this.size=e,this.fontFace=s,this.lineSpacing=i,this.targetWidth=n,this.centred=a):(this.colour=t.textColour,this.size=t.textSize,this.fontFace=t.fontFace,this.lineSpacing=t.lineSpacing,this.targetWidth=t.targetTextWidth,this.centred=t.textCentred)}}class x extends D{constructor(t,e,s,i,n,a,r,o,h){super(t,e),this._widths=[],this._lines=[],this._countLines=0,this._canvasFunction=null,this.typeName="Text",this._textStyle=i instanceof b?i:new b(i,n,a,r,o,h||!1),this._lines="string"==typeof s?[s]:s,this._fontLine=this.size+"pt "+this.fontFace}get color(){return this._textStyle.colour}get fontFace(){return this._textStyle.fontFace}get size(){return this._textStyle.size}get lineSpacing(){return this._textStyle.lineSpacing}get centred(){return this._textStyle.centred}set text(t){this._lines=t?t.split("\n"):[],this.requestDraw(),this._recalculateTextBounds=!0}get lines(){return this._lines}set lines(t){this._lines=t,this.requestDraw(),this._recalculateTextBounds=!0}get canvasFunction(){return this._canvasFunction}set canvasFunction(t){this._canvasFunction=t}measureTextForBounds(t){this.transform.bounds.clearDimensions();let e=new k(this.lines,t,this.color,this.size,this.fontFace,this.lineSpacing);this.transform.bounds.addDimension(e.textDimension()),this._recalculateTextBounds=!1}draw(t){this.canvasFunction&&(t.context2D.save(),this.canvasFunction(t.context2D)),t.context2D.fillStyle=this.color,t.context2D.font=this._fontLine,this._recalculateTextBounds&&this.measureTextForBounds(t.context2D);let e=this.transform.position.x()-t.x(),s=this.transform.position.y()-t.y(),i=0,n=0;for(let a=0;a<this._lines.length;a++)n=this.centred?(this._widest-this._widths[a])/2:0,t.context2D.fillText(this._lines[a],e+n,s+i+this.size),i+=this._textStyle.size*this.lineSpacing;this.canvasFunction&&t.context2D.restore()}}class T extends o{}class k{constructor(t,e,s,i,n,a,r,o){this._lines=[],this._widths=[],this._countLines=0,this._lines="string"==typeof t?t.split("\n"):t,this._context2D=e,this._textStyle=s instanceof b?s:new b(s,i,n,a||1,r||void 0,o||!1)}get color(){return this._textStyle.colour}get fontFace(){return this._textStyle.fontFace}get size(){return this._textStyle.size}get lineSpacing(){return this._textStyle.lineSpacing}get textStyle(){return this._textStyle}set text(t){this._lines=t.split("\n")}get lines(){return this._lines}set lines(t){this._lines=t}buildText(t){let e=this.textDimension();return new x(t,new g(e),this.lines,this.textStyle)}textDimension(){let t=[];this._textStyle.targetWidth?(this._context2D.font=this.size+"pt "+this.fontFace,this.lines.forEach(e=>t=t.concat(this._getWrappedLines(this._context2D,e,this._textStyle.targetWidth)))):t=this.lines,this._context2D.font=this.size+"pt "+this.fontFace;let e=0,s=0,i=[];for(let n=0;n<t.length;n++)i[n]=this._context2D.measureText(t[n]).width,e=Math.max(e,i[n]),n===t.length-1?s+=this.size:s+=this.size*this.lineSpacing;return this.lines=t,new T(e,s)}_getWrappedLines(t,e,s){var i=e.split(" "),n="";let a=[];for(var r=0;r<i.length;r++){var o=n+i[r];t.measureText(o).width>s&&r>0?(a.push(n.trimRight()),n=i[r]+" "):n=o+" "}return a.push(n.trimRight()),a}}class C extends D{constructor(t,e,s,i,n){super(t,e),this.typeName="Shape",this._strokeStyle=void 0,this._fillStyle=void 0,this._lineWidth=void 0,this.strokeStyle=s,this.fillStyle=i,this.lineWidth=n}get strokeStyle(){return this._strokeStyle}get fillStyle(){return this._fillStyle}get lineWidth(){return this._lineWidth}set strokeStyle(t){this._strokeStyle=t}set lineWidth(t){this._lineWidth=t}set fillStyle(t){this._fillStyle=t}}class R extends C{constructor(t,e,s,i,n,a){super(t,e,s,i,n),this.typeName="RoundedRect",this._canvasFunction=null,this._radii=a instanceof Array?a:[a,a,a,a]}get canvasFunction(){return this._canvasFunction}set canvasFunction(t){this._canvasFunction=t}draw(t){this.canvasFunction&&(t.context2D.save(),this.canvasFunction(t.context2D)),t.context2D.strokeStyle=this.strokeStyle,t.context2D.lineWidth=this.lineWidth,t.context2D.fillStyle=this.fillStyle;let e=this.transform.position.x()-t.x(),s=this.transform.position.y()-t.y(),i=void 0!==this.fillStyle,n=void 0!==this.strokeStyle;this._roundRect(t.context2D,e,s,this.transform.bounds.width(),this.transform.bounds.height(),this._radii,i,n),this.canvasFunction&&t.context2D.restore()}_roundRect(t,e,s,i,n,a,r,o){t.beginPath(),t.moveTo(e+a[0],s),t.lineTo(e+i-a[1],s),t.quadraticCurveTo(e+i,s,e+i,s+a[1]),t.lineTo(e+i,s+n-a[2]),t.quadraticCurveTo(e+i,s+n,e+i-a[2],s+n),t.lineTo(e+a[3],s+n),t.quadraticCurveTo(e,s+n,e,s+n-a[3]),t.lineTo(e,s+a[0]),t.quadraticCurveTo(e,s,e+a[0],s),t.closePath(),r&&t.fill(),o&&t.stroke()}}class S extends C{constructor(){super(...arguments),this.typeName="Rect",this._canvasFunction=null}get canvasFunction(){return this._canvasFunction}set canvasFunction(t){this._canvasFunction=t}draw(t){this.canvasFunction&&(t.context2D.save(),this.canvasFunction(t.context2D));let e=this.transform.position.x()-t.x(),s=this.transform.position.y()-t.y();this.fillStyle&&this._filled(t.context2D,e,s,this.transform.bounds.width(),this.transform.bounds.height()),this.lineWidth>0&&this.strokeStyle&&this._outline(t.context2D,e,s,this.transform.bounds.width(),this.transform.bounds.height()),this.canvasFunction&&t.context2D.restore()}_outline(t,e,s,i,n){t.strokeStyle=this.strokeStyle,t.lineWidth=this.lineWidth,t.beginPath(),t.rect(e+this.lineWidth/2,s+this.lineWidth/2,i-this.lineWidth,n-this.lineWidth),t.stroke()}_filled(t,e,s,i,n){t.fillStyle=this.fillStyle,t.beginPath(),t.fillRect(e,s,i,n)}}class M extends S{constructor(t,e,s){super(t,e,void 0,s,0)}}class A{constructor(){this.inBounds=!1,this.clickStarted=!1,this.toDestroy=!1}}class E extends D{constructor(t,e){super(t,e),this.typeName="MouseTrigger",this._pointerData=[],this._onlyIfUnhandled=!1}get onlyIfUnhandled(){return this._onlyIfUnhandled}set onlyIfUnhandled(t){this._onlyIfUnhandled=t}create(t,e,s){for(;this._pointerData.length<s.mouse.maxPointers;)this._pointerData.push(new A)}begin(t,e,s){this.interactable&&this.checkMouseActions(s.mouse)}checkMouseActions(t){t.wheelEvent&&this.onWheel(t);for(let t=0,e=this._pointerData.length;t<e;t++)this._pointerData[t].toDestroy=!0;for(let e=0,s=t.pointers.length;e<s;e++)if(e<t.maxPointers&&(!this.onlyIfUnhandled||!t.pointers[e].handled)){let s=this._pointerData[e],i=t.pointers[e];s.toDestroy=!1,this.transform.containsPoint(i.x,i.y)?(s.inBounds||this.onMouseEnter(t,i),s.inBounds=!0,this.onMouseHover(t,i),i.isStartEvent&&(s.clickStarted=!0,this.onMouseDown(t,i)),i.isMoveEvent&&(this.onMouseMove(t,i),i.isDown&&this.onMouseDrag(t,i)),i.isEndEvent&&(this.onMouseUp(t,i),s.inBounds=!1,s.clickStarted&&(this.onMouseClick(t,i),s.clickStarted=!1))):(s.inBounds&&(this.onMouseLeave(t,i),s.inBounds=!1),s.clickStarted&&i.isEndEvent&&(s.clickStarted=!1))}for(let e=0,s=this._pointerData.length;e<s;e++)this._pointerData[e].toDestroy&&this._pointerData[e].inBounds&&(this.onMouseLeave(t,null),this._pointerData[e].inBounds=!1)}onMouseHover(t,e){}onMouseMove(t,e){}onMouseDown(t,e){}onMouseUp(t,e){}onMouseDrag(t,e){}onMouseLeave(t,e){}onMouseEnter(t,e){}onMouseClick(t,e){}onWheel(t){}}class F extends E{constructor(t,e){super(t,e),this.typeName="ClickTrigger",this.handleClicks=!1,this._firedThisUpdate=!1,this._onClick=new p}get onClick(){return this._onClick}suppressThisUpdate(){this._firedThisUpdate=!0}onMouseClick(t,e){this._firedThisUpdate||(this.onClick.call(t,e),this._firedThisUpdate=!0,this.handleClicks&&(e.handled=!0))}begin(t,e,s){this._firedThisUpdate=!1,super.begin(t,e,s)}}class O extends a{}class B extends F{constructor(t,e,s){super(t,e),this.typeName="Button",this._buttonReset=!1,this._pressed=!1,this._content=s,this.onlyIfUnhandled=!0,this.handleClicks=!0}get content(){return this._content}get hoverRect(){return this._hoverRect}get pressedRect(){return this._pressedRect}get backgroundRect(){return this._backgroundRect}get depressDistance(){return this._depressDistance}setDepressDistance(t){this._depressDistance=t,!this._depressTranslation&&this._depressDistance?(this._depressTranslation=new O(this._pressed?this._depressDistance:new n(0,0)),this._content&&this._content.transform.position.addTranslation(this._depressTranslation),this._backgroundRect&&this._backgroundRect.transform.position.addTranslation(this._depressTranslation),this._hoverRect&&this._hoverRect.transform.position.addTranslation(this._depressTranslation),this._pressedRect&&this._pressedRect.transform.position.addTranslation(this._depressTranslation)):this._depressTranslation&&this._depressDistance&&this._pressed&&(this._depressTranslation.innerX=this._depressDistance.x,this._depressTranslation.innerY=this._depressDistance.y,this._content&&this._content.transform.recalculate(),this._backgroundRect&&this._backgroundRect.transform.recalculate(),this._hoverRect&&this._hoverRect.transform.recalculate(),this._pressedRect&&this._pressedRect.transform.recalculate())}setHoverRect(t){return this._hoverRect=t,this._hoverRect.visible=!1,this._depressTranslation&&this._hoverRect.transform.position.addTranslation(this._depressTranslation),t}setPressedRect(t){return this._pressedRect=t,this._pressedRect.visible=!1,this._depressTranslation&&this._pressedRect.transform.position.addTranslation(this._depressTranslation),t}setBackgroundRect(t){return this._backgroundRect=t,this._depressTranslation&&this._backgroundRect.transform.position.addTranslation(this._depressTranslation),t}reset(){this.hoverRect&&(this.hoverRect.visible=!1),this.pressedRect&&(this.pressedRect.visible=!1),this.requestDraw(),this._buttonReset=!0,this._pressed=!1,this._depressTranslation&&(this._depressTranslation.innerX=0,this._depressTranslation.innerY=0,this._content&&this._content.transform.recalculate(),this._backgroundRect&&this._backgroundRect.transform.recalculate(),this._hoverRect&&this._hoverRect.transform.recalculate(),this._pressedRect&&this._pressedRect.transform.recalculate())}create(t,e,s){super.create(t,e,s),this._content&&this.addChild(this._content)}onMouseClick(t,e){this._buttonReset||super.onMouseClick(t,e),e.handled=!0}onMouseMove(t,e){e.handled=!0}onMouseDown(t,e){this._buttonReset=!1,this._pressed=!0,this.pressedRect&&(this.pressedRect.visible=!0),this.hoverRect&&(this.hoverRect.visible=!1),this._depressTranslation&&(this._depressTranslation.innerX=this._depressDistance.x,this._depressTranslation.innerY=this._depressDistance.y,this._content&&this._content.transform.recalculate(),this._backgroundRect&&this._backgroundRect.transform.recalculate(),this._hoverRect&&this._hoverRect.transform.recalculate(),this._pressedRect&&this._pressedRect.transform.recalculate()),e.handled=!0}onMouseUp(t,e){this._depressTranslation&&(this._depressTranslation.innerX=0,this._depressTranslation.innerY=0,this._content&&this._content.transform.recalculate(),this._backgroundRect&&this._backgroundRect.transform.recalculate(),this._hoverRect&&this._hoverRect.transform.recalculate(),this._pressedRect&&this._pressedRect.transform.recalculate()),this.pressedRect&&(this.pressedRect.visible=!1),this.hoverRect&&(this.hoverRect.visible=!0),e.handled=!0}onMouseEnter(t,e){this.hoverRect&&(this.hoverRect.visible=!0),e.handled=!0}onMouseLeave(t,e){this._pressed=!1,this._depressTranslation&&(this._depressTranslation.innerX=0,this._depressTranslation.innerY=0,this._content&&this._content.transform.recalculate(),this._backgroundRect&&this._backgroundRect.transform.recalculate(),this._hoverRect&&this._hoverRect.transform.recalculate(),this._pressedRect&&this._pressedRect.transform.recalculate()),this.hoverRect&&(this.hoverRect.visible=!1),this.pressedRect&&(this.pressedRect.visible=!1)}}class U extends E{constructor(){super(...arguments),this.typeName="AsyncClickTrigger",this.onClick=new u}create(t,e,s){super.create(t,e,s),this._clickAsyncEvent=s.mouse.onClickAsync,s.mouse.onClickAsync.push(this._asyncClick.bind(this),this)}_asyncClick(t,e){this._pointerData[e.id].clickStarted&&this.transform.containsPoint(e.x,e.y)&&this.active&&this.onClick.call()}destroy(){this._clickAsyncEvent.unregister(this)}}class P extends U{constructor(t,e,s){super(t,e),this.typeName="AsyncButton",this._buttonReset=!1,this._pressed=!1,this._content=s,this.onlyIfUnhandled=!0}get content(){return this._content}get hoverRect(){return this._hoverRect}get pressedRect(){return this._pressedRect}get backgroundRect(){return this._backgroundRect}get depressDistance(){return this._depressDistance}setDepressDistance(t){this._depressDistance=t,!this._depressTranslation&&this._depressDistance?(this._depressTranslation=new O(this._pressed?this._depressDistance:new n(0,0)),this._content&&this._content.transform.position.addTranslation(this._depressTranslation),this._backgroundRect&&this._backgroundRect.transform.position.addTranslation(this._depressTranslation),this._hoverRect&&this._hoverRect.transform.position.addTranslation(this._depressTranslation),this._pressedRect&&this._pressedRect.transform.position.addTranslation(this._depressTranslation)):this._depressTranslation&&this._depressDistance&&this._pressed&&(this._depressTranslation.innerX=this._depressDistance.x,this._depressTranslation.innerY=this._depressDistance.y,this._content&&this._content.transform.recalculate(),this._backgroundRect&&this._backgroundRect.transform.recalculate(),this._hoverRect&&this._hoverRect.transform.recalculate(),this._pressedRect&&this._pressedRect.transform.recalculate())}setHoverRect(t){return this._hoverRect=t,this._hoverRect.visible=!1,this._depressTranslation&&this._hoverRect.transform.position.addTranslation(this._depressTranslation),t}setPressedRect(t){return this._pressedRect=t,this._pressedRect.visible=!1,this._depressTranslation&&this._pressedRect.transform.position.addTranslation(this._depressTranslation),t}setBackgroundRect(t){return this._backgroundRect=t,this._depressTranslation&&this._backgroundRect.transform.position.addTranslation(this._depressTranslation),t}reset(){this.hoverRect&&(this.hoverRect.visible=!1),this.pressedRect&&(this.pressedRect.visible=!1),this.requestDraw(),this._buttonReset=!0,this._pressed=!1,this._depressTranslation&&(this._depressTranslation.innerX=0,this._depressTranslation.innerY=0,this._content&&this._content.transform.recalculate(),this._backgroundRect&&this._backgroundRect.transform.recalculate(),this._hoverRect&&this._hoverRect.transform.recalculate(),this._pressedRect&&this._pressedRect.transform.recalculate())}create(t,e,s){super.create(t,e,s),this._content&&this.addChild(this._content)}onMouseClick(t,e){this._buttonReset||super.onMouseClick(t,e),e.handled=!0}onMouseMove(t,e){e.handled=!0}onMouseDown(t,e){this._buttonReset=!1,this._pressed=!0,this.pressedRect&&(this.pressedRect.visible=!0),this.hoverRect&&(this.hoverRect.visible=!1),this._depressTranslation&&(this._depressTranslation.innerX=this._depressDistance.x,this._depressTranslation.innerY=this._depressDistance.y,this._content&&this._content.transform.recalculate(),this._backgroundRect&&this._backgroundRect.transform.recalculate(),this._hoverRect&&this._hoverRect.transform.recalculate(),this._pressedRect&&this._pressedRect.transform.recalculate()),e.handled}onMouseUp(t,e){this._depressTranslation&&(this._depressTranslation.innerX=0,this._depressTranslation.innerY=0,this._content&&this._content.transform.recalculate(),this._backgroundRect&&this._backgroundRect.transform.recalculate(),this._hoverRect&&this._hoverRect.transform.recalculate(),this._pressedRect&&this._pressedRect.transform.recalculate()),this.pressedRect&&(this.pressedRect.visible=!1),this.hoverRect&&(this.hoverRect.visible=!0),e.handled}onMouseEnter(t,e){this.hoverRect&&(this.hoverRect.visible=!0),e.handled}onMouseLeave(t,e){this._pressed=!1,this._depressTranslation&&(this._depressTranslation.innerX=0,this._depressTranslation.innerY=0,this._content&&this._content.transform.recalculate(),this._backgroundRect&&this._backgroundRect.transform.recalculate(),this._hoverRect&&this._hoverRect.transform.recalculate(),this._pressedRect&&this._pressedRect.transform.recalculate()),this.hoverRect&&(this.hoverRect.visible=!1),this.pressedRect&&(this.pressedRect.visible=!1)}}class L{static createText(t,e,s,i,n){let a,r;return a=i instanceof b?i:new b(i),r=s,void 0!==n&&(a.targetWidth=n),new k(r,e,a).buildText(t instanceof w?t:new w)}static createRect(t,e,s){let i=s.rounding;return i>0?new R(t,e,s.strokeColour,s.backgroundColour,s.strokeWidth,i):new S(t,e,s.strokeColour,s.backgroundColour,s.strokeWidth)}static createButton(t,e,s,i){let n=new B(t,e,s);return n.setBackgroundRect(n.addChild(L.createRect(new w,g.fill,i))),n.setHoverRect(n.addChild(L.createRect(new w,g.fill,i.hover))),n.setPressedRect(n.addChild(L.createRect(new w,g.fill,i.pressed))),n.setDepressDistance(i.depressDistance),n}static createFullscreenButton(t,e,s,i,n){let a=new P(t,e,s);return a.setBackgroundRect(a.addChild(L.createRect(new w,g.fill,i))),a.setHoverRect(a.addChild(L.createRect(new w,g.fill,i.hover))),a.setPressedRect(a.addChild(L.createRect(new w,g.fill,i.pressed))),a.setDepressDistance(i.depressDistance),a.onClick.push(()=>{n.isFullscreen?document.exitFullscreen():n.requestFullscreen()},null),a}}class W extends D{constructor(t,e){super(t,e),this._canvas=null,this._context2D=null,this._hasAlphaChannel=!0,this.debugDisableCache=!1,this.transform.hasPosition()&&(this.x=this.transform.position.x.bind(this.transform.position),this.y=this.transform.position.y.bind(this.transform.position))}x(){return 0}y(){return 0}get context2D(){return this._context2D}get container(){return this._container}set container(t){this._container=t}get canvas(){return this._canvas}get canvasUsedWidth(){return Math.ceil(this.transform.bounds.width()*this.pixelRatio)}get canvasUsedHeight(){return Math.ceil(this.transform.bounds.height()*this.pixelRatio)}get backgroundColor(){return this._backgroundColor}set backgroundColor(t){this._backgroundColor=t}get pixelRatio(){return this._pixelRatio}get hasAlphaChannel(){return this._hasAlphaChannel}set hasAlphaChannel(t){this._hasAlphaChannel!==t&&this._canvas&&(this._context2D=this._canvas.getContext("2d",{alpha:t})),this._hasAlphaChannel=t}clear(){this.backgroundColor?(this._context2D.fillStyle=this.backgroundColor,this._context2D.fillRect(0,0,this._canvas.width/this.pixelRatio,this._canvas.height/this.pixelRatio)):this._context2D.clearRect(0,0,this.canvas.width/this.pixelRatio,this.canvas.height/this.pixelRatio)}create(t,e,s){this._createDrawBuffer(e),this._container&&e.addCanvasToPage(this.canvas,this._container),L.context2D||(L.context2D=this.context2D)}begin(t,e,s){this._container&&(s.mouse&&(s.mouse.htmlElementForOffset=this._canvas),e.activeContainer=this._container),this._hasResized()||this._pixelRatio!==e.devicePixelRatio?(this._resizeCanvas(this.transform.bounds.width(),this.transform.bounds.height(),e.devicePixelRatio),this.requestDraw()):this.debugDisableCache&&this.requestDraw()}_createDrawBuffer(t){this._canvas=t.createCanvas(),this._context2D=this._canvas.getContext("2d",{alpha:this.hasAlphaChannel}),this._resizeCanvas(this.transform.bounds.width(),this.transform.bounds.height(),t.devicePixelRatio),this.clear()}_resizeCanvas(t,e,s){this._pixelRatio=s,this.canvas.width=Math.max(t*this.pixelRatio,W.minCanvasSize),this.canvas.height=Math.max(e*this.pixelRatio,W.minCanvasSize),this.canvas.style.width=Math.max(this.transform.bounds.width(),W.minCanvasSize/this.pixelRatio)+"px",this.canvas.style.height=Math.max(this.transform.bounds.height(),W.minCanvasSize/this.pixelRatio)+"px",this._oldDimensionX=t,this._oldDimensionY=e,this._context2D.setTransform(1,0,0,1,0,0),this._context2D.scale(this.pixelRatio,this.pixelRatio)}_hasResized(){return this._oldDimensionX!==this.transform.bounds.width()||this._oldDimensionY!==this.transform.bounds.height()}}W.minCanvasSize=256;class Y extends D{constructor(t,e,s){super(new X(t,e)),this.typeName="DrawBuffer",this._drawRequested=!1,this._forgetInternalsOnDraw=!1,this._canvasDrawFixed=!1,this._cameras=[],this.transform.position&&(this.transform.position.resetDrawPos=!0),!1!==s&&this.addCamera(this.addChild(new W(new w,g.fill)))}get forgetInternalsOnDraw(){return this._forgetInternalsOnDraw}set forgetInternalsOnDraw(t){this._forgetInternalsOnDraw=t}get drawRequested(){return this._drawRequested}get cameras(){return this._cameras}get mainCamera(){return this._mainCamera}set mainCamera(t){this._mainCamera=t}doDraw(t){if(this.created){if(this._drawRequested&&!this._canvasDrawFixed){this._drawRequested=!1;for(let t=0,e=this._cameras.length;t<e;t++)this._cameras[t].visible&&this._cameras[t].created&&this._drawCamera(this._cameras[t]);if(this._forgetInternalsOnDraw){for(let t=0,e=this.children.length;t<e;t++)this.removeChild(this.children[t]);this._canvasDrawFixed=!0}}this.draw(t)}}requestDraw(t){this._drawRequested=!0,super.requestDraw(t)}addCamera(t){return this._cameras.push(t),1===this._cameras.length&&(this._mainCamera=t),t}draw(t){if(t&&this.transform.position&&this.visible&&this.mainCamera){let e=void 0;if(1!==this.opacity){let e=t.context2D.globalAlpha;t.context2D.globalAlpha=e*this.opacity}this.transform.position.resetDrawPos=!1;let s=this.transform.position.x()-t.x(),i=this.transform.position.y()-t.y(),n=this.transform.bounds.width(),a=this.transform.bounds.height();this.transform.position.resetDrawPos=!0,t.context2D.drawImage(this.mainCamera.canvas,0,0,Math.round(n)*this.mainCamera.pixelRatio,Math.round(a)*this.mainCamera.pixelRatio,Math.round(s),Math.round(i),Math.round(n),Math.round(a)),e&&(t.context2D.globalAlpha=e)}}_drawCamera(t){t.context2D.globalAlpha=1,t.clear();for(let e=0,s=this.children.length;e<s;e++)this.children[e].doDraw(t)}}class X extends i{recalculate(t){t||this.bounds.hasResizedAutoUpdate()||(t=!0,super.gameObject.requestDraw()),super.recalculate(t)}}var I;!function(t){t[t.Floor=0]="Floor",t[t.Void=1]="Void"}(I||(I={}));var K=s(1),z=s.n(K);class H{constructor(t,e,s){this._sheet=t,this._tileHeight=s,this._tileWidth=e,this._width=Math.ceil(t.naturalWidth/this._tileWidth)}get tileWidth(){return this._tileWidth}get tileHeight(){return this._tileHeight}getTileX(t){return t%this._width}getTileY(t){return Math.floor(t/this._width)}draw(t,e,s,i,n,a){t.drawImage(this._sheet,this.getTileX(i)*this._tileWidth,this.getTileY(i)*this._tileHeight,this._tileWidth,this._tileHeight,e,s,n||this._tileWidth,a||this._tileHeight)}}class j extends D{constructor(t,e,s,i){super(t,e),this._tileMap=s,this._spriteSheet=i}draw(t){for(let e=0,s=this._tileMap.length;e<s;e++)for(let s=0,i=this._tileMap[e].length;s<i;s++){let i=this.transform.position.x()-t.x(),n=this.transform.position.y()-t.y(),a=Math.round(e*this._spriteSheet.tileWidth+i),r=Math.round(s*this._spriteSheet.tileHeight+n);this._spriteSheet.draw(t.context2D,a,r,this._tileMap[e][s])}}}class q extends Y{constructor(t,e,s,i){super(t,e),this._data=s,this._localData=i}load(t){return this.addAsset(t.loadImage(z.a,()=>{})),!0}create(t,e,s){super.create(t,e,s);let i=new H(this.getAsset(z.a),16,16);this.addChild(new j(new w,g.fill,this._createTileMap(this._data.map),i))}_createTileMap(t){let e=[22,23,24,43,44,45,64,65,66],s=[1,2,3],i=[85,86,87],n=[25,46,67],a=[21,42,63],r=[0],o=[4],h=[84],c=[88],l=[53],d=[90],u=new Array(t.length);for(let _=0,m=u.length;_<m;_++){u[_]=new Array(t[_].length);for(let m=0,p=u.length;m<p;m++)t[_][m]===I.Floor?0===_||0===m||_===t.length-1||m===t[0].length-1?u[_][m]=e[Math.round(Math.random()*(e.length-1))]:t[_-1][m]===I.Void?t[_][m-1]===I.Void?u[_][m]=r[Math.round(Math.random()*(r.length-1))]:t[_][m+1]===I.Void?u[_][m]=h[Math.round(Math.random()*(h.length-1))]:u[_][m]=a[Math.round(Math.random()*(a.length-1))]:t[_+1][m]===I.Void?t[_][m-1]===I.Void?u[_][m]=o[Math.round(Math.random()*(o.length-1))]:t[_][m+1]===I.Void?u[_][m]=c[Math.round(Math.random()*(c.length-1))]:u[_][m]=n[Math.round(Math.random()*(n.length-1))]:t[_][m-1]===I.Void?u[_][m]=s[Math.round(Math.random()*(s.length-1))]:t[_][m+1]===I.Void?u[_][m]=i[Math.round(Math.random()*(i.length-1))]:u[_][m]=e[Math.round(Math.random()*(e.length-1))]:t[_][m]===I.Void&&(m>0&&t[_][m-1]===I.Floor?u[_][m]=d[Math.round(Math.random()*(d.length-1))]:u[_][m]=l[Math.round(Math.random()*(l.length-1))])}return u}}var N,Z,G,V=s(0),J=s.n(V);class Q extends D{constructor(t,e,s,i){super(t,e),this._data=s,this._localData=i}load(t){return this.addAsset(t.loadImage(J.a,()=>{console.warn("Image failed to load:"+J.a)})),!0}create(){this._spriteSheet=new H(this.getAsset(J.a),20,20)}draw(t){let e=this._localData.worldScale;for(let s=0,i=this._data.agents.length;s<i;s++)for(let i=0,n=this._data.agentsLength[s];i<n;i++){let n=this._data.agents[s][i],a=this.transform.position.x()-t.x(),r=this.transform.position.y()-t.y(),o=Math.round(n.x*e+a)-n.collideRadius*e,h=Math.round(n.y*e+r)-n.collideRadius*e;this._spriteSheet.draw(t.context2D,o,h,s%3,n.collideRadius*e*2,n.collideRadius*e*2),n.health<n.maxHealth&&(t.context2D.fillStyle="darkred",t.context2D.fillRect(o,h,n.collideRadius*e*2,this._localData.baseZoom),t.context2D.fillStyle="red",t.context2D.fillRect(o,h,n.collideRadius*e*2*n.health/n.maxHealth,this._localData.baseZoom))}let s=["red","green","blue"];for(let i=0,n=this._data.projectilesLength;i<n;i++){let n=this._data.projectiles[i],a=this.transform.position.x()-t.x(),r=this.transform.position.y()-t.y(),o=n.x*e+a-n.collideRadius*e,h=n.y*e+r-n.collideRadius*e;t.context2D.fillStyle=s[n.team%s.length],t.context2D.fillRect(o,h,n.collideRadius*e*2,n.collideRadius*e*2)}}}class ${constructor(){this.tileSize=16,this.baseZoom=8,this.cameraX=0,this.cameraY=0,this.cameraScale=1,this.cameraSpeed=1e3,this.viewportWidth=1,this.viewportHeight=1,this.sidePadding=2}get worldScale(){return this.tileSize*this.baseZoom}}class tt extends W{constructor(t,e,s,i){super(t,e),this._localData=i,this._pos=t.addTranslation(new O(0,0)),this._dim=s}begin(t,e,s){super.begin(t,e,s),this._move(this._localData.cameraX,this._localData.cameraY,t.deltaSeconds),this._scale(this._localData.cameraScale,this._localData.cameraScale)}_move(t,e,s){this._pos.innerX+=.1*(t-this._pos.innerX),this._pos.innerY+=.1*(e-this._pos.innerY),this.transform.positioningIsDirty()}_scale(t,e){this._dim.height+=.1*(e-this._dim.height),this._dim.width+=.1*(t-this._dim.width),this.transform.positioningIsDirty()}}class et{constructor(){this.onCommandRecieved=new _}recieveCommand(t){this.onCommandRecieved.call(t)}}class st{constructor(t){this._invoker=t}recieveCommand(t){this._invoker.invoke(t)}}class it{constructor(){this._callbacks=new Map}invoke(t){let e=this._callbacks.get(t.commandType);e&&e.call(t)}push(t,e,s){let i=this._callbacks.get(t);i?i.push(e,s):(this._callbacks.set(t,new nt),this._callbacks.get(t).push(e,s))}copy(t){let e=this._callbacks.get(t);return e?e.clone():null}unregister(t){let e=this._callbacks.values(),s=e.next();for(;!s.done;)s.value.unregister(t),s=e.next()}remove(t,e){let s=this._callbacks.get(t);s&&s.remove(e)}removeAll(t){let e=this._callbacks.get(t);e&&e.removeAll()}clear(){this._callbacks.clear()}}class nt extends _{call(t){super.call(t)}push(t,e){return super.push(t,e)}}class at{constructor(t,e,s){this.commandType=t,this.clientID=e,this.teamID=s}}!function(t){t[t.AgentMoveNorth=0]="AgentMoveNorth",t[t.AgentMoveSouth=1]="AgentMoveSouth",t[t.AgentMoveEast=2]="AgentMoveEast",t[t.AgentMoveWest=3]="AgentMoveWest",t[t.SpawnProjectile=4]="SpawnProjectile"}(N||(N={}));class rt extends at{constructor(t,e,s,i){super(t,e,s),this.agentID=i}}!function(t){t[t.Update=0]="Update",t[t.CameraMove=1]="CameraMove",t[t.AgentMove=2]="AgentMove",t[t.TargetMove=3]="TargetMove",t[t.ActionStart=4]="ActionStart",t[t.ActionStop=5]="ActionStop",t[t.ZoomIn=6]="ZoomIn",t[t.ZoomOut=7]="ZoomOut"}(Z||(Z={}));class ot{constructor(t,e,s){this._deltaSeconds=0,this._fbCommand=new rt(N.AgentMoveNorth,0,0,0),this._localData=e,this._connection=s,this._data=t}create(t){t.push(Z.AgentMove,this._agentMove.bind(this),this),t.push(Z.TargetMove,this._targetMove.bind(this),this),t.push(Z.CameraMove,this._cameraMoveCommand.bind(this),this),t.push(Z.Update,this._update.bind(this),this),t.push(Z.ZoomIn,this._cameraZoom.bind(this),this),t.push(Z.ZoomOut,this._cameraZoom.bind(this),this),t.push(Z.ActionStart,this._action.bind(this),this),t.push(Z.ActionStop,this._action.bind(this),this)}_update(t){this._deltaSeconds=t.arg;let e=0,s=0,i=this._localData.cameraX+this._localData.viewportWidth*this._localData.cameraScale;this._localData.cameraX<0&&(e+=-this._localData.cameraX),i>this._localData.worldScale*this._data.map.length&&(e+=this._localData.worldScale*this._data.map.length-i);let n=this._localData.cameraY+this._localData.viewportHeight*this._localData.cameraScale;this._localData.cameraY<0&&(s+=-this._localData.cameraY),n>this._localData.worldScale*this._data.map[0].length&&(s+=this._localData.worldScale*this._data.map[0].length-n),this._cameraMove(e/100*this._localData.sidePadding,s/100*this._localData.sidePadding)}_targetMove(t){}_action(t){}_agentMove(t){let e=t.arg1,s=t.arg2;-1===s?(this._fbCommand.commandType=N.AgentMoveNorth,this._connection.recieveCommand(this._fbCommand)):1===s?(this._fbCommand.commandType=N.AgentMoveSouth,this._connection.recieveCommand(this._fbCommand)):-1===e?(this._fbCommand.commandType=N.AgentMoveWest,this._connection.recieveCommand(this._fbCommand)):1===e&&(this._fbCommand.commandType=N.AgentMoveEast,this._connection.recieveCommand(this._fbCommand))}_cameraMoveCommand(t){this._cameraMove(t.arg1,t.arg2)}_cameraMove(t,e){let s=t*this._deltaSeconds*this._localData.cameraSpeed*this._localData.cameraScale,i=e*this._deltaSeconds*this._localData.cameraSpeed*this._localData.cameraScale;this._localData.cameraX+=s,this._localData.cameraY+=i}_cameraZoom(t){let e=this._localData.cameraScale;t.commandType===Z.ZoomIn?this._localData.cameraScale=Math.max(this._localData.cameraScale-10*this._deltaSeconds,1):t.commandType===Z.ZoomOut&&(this._localData.cameraScale=Math.min(this._localData.cameraScale+10*this._deltaSeconds,4)),this._localData.cameraX+=.5*(this._localData.viewportWidth*e-this._localData.viewportWidth*this._localData.cameraScale),this._localData.cameraY+=.5*(this._localData.viewportHeight*e-this._localData.viewportHeight*this._localData.cameraScale)}}class ht{constructor(t){this._commandType=t}get commandType(){return this._commandType}set commandType(t){this._commandType=t}}class ct extends ht{constructor(t,e){super(t),this._arg=e}get arg(){return this._arg}set arg(t){this._arg=t}}class lt extends ht{constructor(t,e,s){super(t),this._arg1=e,this._arg2=s}get arg1(){return this._arg1}set arg1(t){this._arg1=t}get arg2(){return this._arg2}set arg2(t){this._arg2=t}}class dt extends E{constructor(t,e,s){super(t,e),this._controller=s,this._command0=new ht(Z.ActionStop),this._command2=new lt(Z.TargetMove,0,0)}onMouseMove(t,e){this._command2.arg1=e.x-this.transform.position.x(),this._command2.arg2=e.y-this.transform.position.y(),this._command2.commandType=Z.TargetMove,this._controller.recieveCommand(this._command2)}onMouseDown(t,e){this._command0.commandType=Z.ActionStart,this._controller.recieveCommand(this._command0)}onMouseUp(t,e){this._command0.commandType=Z.ActionStop,this._controller.recieveCommand(this._command0)}onMouseLeave(t,e){this._command0.commandType=Z.ActionStop,this._controller.recieveCommand(this._command0)}onWheel(t){t.wheelY>0?(this._command0.commandType=Z.ZoomOut,this._controller.recieveCommand(this._command0)):t.wheelY<0&&(this._command0.commandType=Z.ZoomIn,this._controller.recieveCommand(this._command0))}}!function(t){t[t.onKeyPress=0]="onKeyPress",t[t.onKeyNewDown=1]="onKeyNewDown",t[t.onKeyIsDown=2]="onKeyIsDown",t[t.onKeyUp=3]="onKeyUp"}(G||(G={}));class ut extends D{constructor(){super(null,null),this.typeName="KeyTrigger",this._keys=[],this._newKeysDown=[]}getKeyEvent(t,e){void 0===e&&(e=G.onKeyIsDown);for(let s=0,i=this._keys.length;s<i;s++)if(this._keys[s].keycode===t&&this._keys[s].trigger===e)return this._keys[s].event;let s=new u;return this._keys.push({keycode:t,trigger:e,event:s}),s}removeKeyEvent(t,e){let s=this._keys.filter(s=>s.keycode===t&&s.trigger===e);if(s.length>0){for(let t=0;t<s.length;t++)v(this._keys,this._keys.indexOf(s[t]));return!0}return!1}begin(t,e,s){if(this.interactable)for(let t=0,e=this._keys.length;t<e;t++)this._keys[t].trigger===G.onKeyUp?s.keyboard.isKeyUp(this._keys[t].keycode)&&this._keys[t].event.call():this._keys[t].trigger===G.onKeyIsDown?s.keyboard.isKeyDown(this._keys[t].keycode)&&this._keys[t].event.call():this._keys[t].trigger===G.onKeyPress?s.keyboard.isKeyPressed(this._keys[t].keycode)&&this._keys[t].event.call():this._keys[t].trigger===G.onKeyNewDown&&(s.keyboard.isKeyDown(this._keys[t].keycode)?-1===this._newKeysDown.indexOf(this._keys[t].keycode)&&(this._newKeysDown.push(this._keys[t].keycode),this._keys[t].event.call()):-1!==this._newKeysDown.indexOf(this._keys[t].keycode)&&v(this._newKeysDown,this._keys[t].keycode))}}class _t extends D{constructor(t){super(null,null),this._command0=new ht(Z.ActionStop),this._command2=new lt(Z.ActionStop,0,0),this._controller=t,this._moveCommandUp=this._moveCommand.bind(this,0,-1),this._moveCommandDown=this._moveCommand.bind(this,0,1),this._moveCommandLeft=this._moveCommand.bind(this,-1,0),this._moveCommandRight=this._moveCommand.bind(this,1,0),this._moveCameraCommandUp=this._moveCameraCommand.bind(this,0,-1),this._moveCameraCommandDown=this._moveCameraCommand.bind(this,0,1),this._moveCameraCommandLeft=this._moveCameraCommand.bind(this,-1,0),this._moveCameraCommandRight=this._moveCameraCommand.bind(this,1,0)}create(){this.addChild(this._createKeyTrigger())}_moveCameraCommand(t,e){this._command2.commandType=Z.CameraMove,this._command2.arg1=t,this._command2.arg2=e,this._controller.recieveCommand(this._command2)}_moveCommand(t,e){this._command2.commandType=Z.AgentMove,this._command2.arg1=t,this._command2.arg2=e,this._controller.recieveCommand(this._command2)}_actionStart(){this._command0.commandType=Z.ActionStart,this._controller.recieveCommand(this._command0)}_actionStop(){this._command0.commandType=Z.ActionStop,this._controller.recieveCommand(this._command0)}_createKeyTrigger(){let t=new ut;return t.getKeyEvent("ArrowUp",G.onKeyIsDown).push(this._moveCameraCommandUp),t.getKeyEvent("ArrowDown",G.onKeyIsDown).push(this._moveCameraCommandDown),t.getKeyEvent("ArrowLeft",G.onKeyIsDown).push(this._moveCameraCommandLeft),t.getKeyEvent("ArrowRight",G.onKeyIsDown).push(this._moveCameraCommandRight),t.getKeyEvent("w",G.onKeyIsDown).push(this._moveCommandUp),t.getKeyEvent("s",G.onKeyIsDown).push(this._moveCommandDown),t.getKeyEvent("a",G.onKeyIsDown).push(this._moveCommandLeft),t.getKeyEvent("d",G.onKeyIsDown).push(this._moveCommandRight),t.getKeyEvent(" ",G.onKeyNewDown).push(this._actionStart.bind(this)),t.getKeyEvent(" ",G.onKeyUp).push(this._actionStop.bind(this)),t}}class mt extends D{constructor(t,e,s,i){super(t,e),this.typeName="BufferClone",this._origin=new O(0,0),this._area=null,this._cameraToDraw=s,this._clipFunction=i}get clipFunction(){return this._clipFunction}set clipFunction(t){this._clipFunction=t}get origin(){return this._origin}set origin(t){this._origin=t}get area(){return this._area}set area(t){this._area=t}get cameraToDraw(){return this._cameraToDraw}draw(t){if(!this._cameraToDraw)throw new Error("Cannot draw bufferclone because the provided Camera is null");if(this._cameraToDraw.created){let e=this.transform.position.x()-t.x(),s=this.transform.position.y()-t.y();this._clipFunction&&(t.context2D.save(),this._clipFunction(t.context2D,e,s,this.transform.bounds.width(),this.transform.bounds.height()),t.context2D.clip());let i=this._cameraToDraw.canvasUsedWidth,n=this._cameraToDraw.canvasUsedHeight;this.area&&(i=this.area.pixelWidth(this.transform.bounds)*this._cameraToDraw.pixelRatio,n=this.area.pixelHeight(this.transform.bounds)*this._cameraToDraw.pixelRatio);let a=this.origin.getOffsetXTopLeft(this._cameraToDraw.transform.bounds),r=this.origin.getOffsetXTopLeft(this._cameraToDraw.transform.bounds);t.context2D.drawImage(this._cameraToDraw.canvas,a*this._cameraToDraw.pixelRatio,r*this._cameraToDraw.pixelRatio,i,n,e,s,this.transform.bounds.width(),this.transform.bounds.height()),this._clipFunction&&t.context2D.restore()}}}let pt={rootGameObjectType:class extends Y{constructor(){super(...arguments),this.typeName="GameRoot",this._updateCommand=new ct(Z.Update,0)}create(t,e,s){super.create(t,e,s),this.addChild(new M(new w,g.fill,"#211e27")),this._localData=new $;let i=new et;this._scenario=this._createScenario(this._localData,i),this._controller=this._createModelController(i),this._worldDB=this.addChild(this._createWorldDB());let a=this.addChild(new mt(new w(new f(.5,.5,new n(.5,.5))),g.fill,this._worldDB.mainCamera)),r=this._localData.tileSize,o=this._scenario.data.map.length*r,h=this._scenario.data.map[0].length*r,c=this._localData.sidePadding*r;a.transform.bounds.maxDimension=new T((o+2*c)*this._localData.baseZoom,(h+2*c)*this._localData.baseZoom),this.addChild(new _t(this._controller)),this.addChild(new dt(new w,g.fill,this._controller))}update(t){this._scenario.update(t.deltaSeconds),this._worldDB.requestDraw(),this._updateCommand.arg=t.deltaSeconds,this._controller.recieveCommand(this._updateCommand),this._localData.viewportWidth=this._worldDB.transform.bounds.width(),this._localData.viewportHeight=this._worldDB.transform.bounds.height(),this._worldDB.mainCamera.context2D.imageSmoothingEnabled=!1,this.mainCamera.context2D.imageSmoothingEnabled=!1}_createScenario(t,e){let s=window.FBScenario;if(!s)throw new Error("No scenario detected in environment. Ensure scenario script has loaded.");let i=s.addLocalClient(e);return i?console.log("Local player connected"):console.log("Scenario full, no local player connected"),t.playing=i,s.create(),s}_createModelController(t){let e=new it;return new ot(this._scenario.data,this._localData,t).create(e),new st(e)}_createWorldDB(){let t=this._localData.tileSize,e=this._scenario.data.map.length*t,s=this._scenario.data.map[0].length*t,i=this._localData.sidePadding*t,n=new Y(null,g.fill,!1);n.transform.bounds.maxDimension=new T((e+2*i)*this._localData.baseZoom,(s+2*i)*this._localData.baseZoom);let a=n.addChild(new q(null,new g(new T(e,s)),this._scenario.data,this._localData));n.addChild(new mt(new w(new O(i*this._localData.baseZoom,i*this._localData.baseZoom)),new g(new T(e*this._localData.baseZoom,s*this._localData.baseZoom)),a.mainCamera));let r=n.addChild(new D(new w(new O(i*this._localData.baseZoom,i*this._localData.baseZoom)),new g(new T(e*this._localData.baseZoom,s*this._localData.baseZoom)))),o=new h(1,1,n.transform.bounds),c=r.addChild(new tt(new w,new g(o),o,this._localData));return n.addCamera(c),n.mainCamera=c,r.addChild(new Q(new w,g.fill,this._scenario.data,this._localData)),n}},minDimension:new T(300,500),maxDimension:new T(700,void 0),backgroundColor:"white",hasAlphaChannel:!1,usesMouse:!0,usesKeyboard:!0,addExtraInputDevices:t=>{},gameTarget:"gameTarget",windowVariableName:void 0,args:{}};class gt extends D{constructor(){super(...arguments),this.typeName="DebugPane",this._beginTime=0,this._drawTime=0,this._endTime=0,this._updateTime=0,this._averageSteps=0,this._loopTime=0,this._valuesAlpha=.02}create(t,e){this._timingText=this.addChild(new x(new w(new O(5,5)),new g,"FPS:",new b("white",12,"serif",2,void 0,!1))),this.addChild(new ut).getKeyEvent("Tab",G.onKeyUp).push(()=>this.visible=!this.visible,this)}updateValues(t,e,s){this._beginTime=this.runningAverage(this._beginTime,t.beginTime,this._valuesAlpha),this._updateTime=this.runningAverage(this._updateTime,t.updateTime,this._valuesAlpha),this._drawTime=this.runningAverage(this._drawTime,t.drawTime,this._valuesAlpha),this._endTime=this.runningAverage(this._endTime,t.endTime,this._valuesAlpha),this._loopTime=this.runningAverage(this._loopTime,t.loopTime,this._valuesAlpha),this._averageSteps=this.runningAverage(this._averageSteps,s,this._valuesAlpha),this._slowDown=t.slowDown}begin(t,e,s){this._timingText.text=("FPS: "+t.fps).substring(0,7)+("\nBegin: "+this._beginTime).substring(0,12)+("\nDraw: "+this._drawTime).substring(0,11)+("\nUpdate: "+this._updateTime).substring(0,13)+("\n(Steps: "+this._averageSteps).substring(0,13)+") "+("\nEnd: "+this._endTime).substring(0,10)+("\nLoop: "+this._loopTime).substring(0,11)+("\n(Calculated FPS: "+Math.round(1e3/this._loopTime)).substring(0,21)+")"+("\n(Rate (-/+): "+100/(this._slowDown+1)).substring(0,17)+"%)"+("\n(Game Speed ([/]): "+100*t.speedFactor).substring(0,23)+"%)"}runningAverage(t,e,s){return s*e+(1-s)*t}}class ft{constructor(){this.loopStart=0,this.loopTime=0,this.beginStart=0,this.beginTime=0,this.updateStart=0,this.updateTime=0,this.drawStart=0,this.drawTime=0,this.endStart=0,this.endTime=0,this.slowDown=0}onBeginStart(){this.loopStart=Date.now(),this.beginStart=this.loopStart}onBeginEnd(){let t=Date.now();this._delay((t-this.beginStart)*this.slowDown),this.beginTime=t-this.beginStart}onUpdateStart(){this.updateStart=Date.now()}onUpdateEnd(){let t=Date.now();this._delay((t-this.updateStart)*this.slowDown),this.updateTime=t-this.updateStart}onDrawStart(){this.drawStart=Date.now()}onDrawEnd(){let t=Date.now();this._delay((t-this.drawStart)*this.slowDown),this.drawTime=t-this.drawStart}onEndStart(){this.endStart=Date.now()}onEndEnd(){let t=Date.now();this._delay((t-this.endStart)*this.slowDown),this.endTime=t-this.endStart,this.loopTime=t-this.loopStart}_delay(t){if(t<=0)return;let e=Date.now(),s=e;for(;s=Date.now(),!(s-e>t););}}let wt={rootGameObjectType:class extends Y{constructor(){super(...arguments),this.typeName="Editor",this._timings=new ft}create(t,e,s){super.create(t,e,s),this.addChild(new M(new w,g.fill,"#1e1e1e")),e.launcherOptions.args.editor&&(this._game=this.addChild(this._createBufferedGame(e)),this._usesMouse=e.launcherOptions.args.editor.usesMouse,this._usesKeyboard=e.launcherOptions.args.editor.usesKeyboard),this._debugPane=this.addChild(new gt(new w,g.fill)),this.addChild(new ut).getKeyEvent("Pause",G.onKeyNewDown).push(()=>{this._game.active=!this._game.active,this._debugPane.active=this._game.active})}doBegin(t,e,s,i){this._timings.onBeginStart(),super.doBegin(t,e,s,i),this._timings.onBeginEnd()}begin(t,e,s){if(super.begin(t,e,s),this.interactable)for(let e=0,i=s.keyboard.keysDown.length;e<i;e++){let i=s.keyboard.keysDown[e];"-"===i?this._timings.slowDown+=1*t.rawDeltaSeconds:"+"===i&&(this._timings.slowDown=Math.max(0,this._timings.slowDown-1*t.rawDeltaSeconds)),"["===i?t.speedFactor=Math.max(0,t.speedFactor-.15*t.rawDeltaSeconds):"]"===i&&(t.speedFactor=Math.min(2,t.speedFactor+.15*t.rawDeltaSeconds))}this._debugPane.updateValues(this._timings,t.fps,t.updateSteps)}doUpdate(t){this._timings.onUpdateStart(),super.doUpdate(t),this._timings.onUpdateEnd()}doDraw(t){this._timings.onDrawStart(),super.doDraw(t),this._timings.onDrawEnd()}doEnd(t){this._timings.onEndStart(),super.doEnd(t),this._timings.onEndEnd()}_createBufferedGame(t){let e=new t.launcherOptions.args.editor.rootGameObjectType(w.centre,new g(new h(1,1)));return e instanceof Y&&(e.mainCamera.backgroundColor=t.launcherOptions.args.editor.backgroundColor,e.mainCamera.hasAlphaChannel=t.launcherOptions.args.editor.hasAlphaChannel),e.transform.bounds.minDimension=t.launcherOptions.args.editor.minDimension,e.transform.bounds.maxDimension=t.launcherOptions.args.editor.maxDimension,e}},minDimension:void 0,maxDimension:void 0,backgroundColor:"white",hasAlphaChannel:!1,usesMouse:!0,usesKeyboard:!0,addExtraInputDevices:t=>{},gameTarget:"gameTarget",windowVariableName:void 0,args:{}};let vt=function(t){let e=wt;return e.addExtraInputDevices=t.addExtraInputDevices,e.gameTarget=t.gameTarget,e.windowVariableName=t.windowVariableName,e.args=t.args,e.args.editor=t,e}(pt);class yt{constructor(){this._inputDevices={},this._ifs=[]}get inputDevices(){return this._inputDevices}onBeginEnd(){for(let t=0,e=this._ifs.length;t<e;t++)this._ifs[t].onBeginEnd()}addInputDevice(t,e){this._inputDevices[e]=t,this._ifs.push(t)}}class Dt{constructor(t,e,s,i){this._simulationTimestep=1e3/60,this._frameDelta=0,this._lastFrameTimeMs=0,this._fps=60,this._fpsAlpha=.9,this._fpsUpdateInterval=1e3,this._lastFpsUpdate=0,this._framesSinceLastFpsUpdate=0,this._numUpdateSteps=0,this._minFrameDelay=0,this._running=!1,this._started=!1,this._panic=!1,this._hasWindow="object"==typeof window,this._lastTimestampForTimeoutMethod=Date.now(),this._begin=t,this._update=e,this._draw=s,this._end=i,this._animateBoundCall=this._animate.bind(this)}get numUpdateSteps(){return this._numUpdateSteps}get simulationTimestep(){return this._simulationTimestep}set simulationTimestep(t){this._simulationTimestep=t}get fps(){return this._fps}get maxAllowedFPS(){return 1e3/this._minFrameDelay}set maxAllowedFPS(t){void 0===t&&(t=1/0),0===t?this.stop():this._minFrameDelay=1e3/t}get running(){return this._running}resetFrameDelta(){var t=this._frameDelta;return this._frameDelta=0,t}start(){return this._started||(this._started=!0,this._rafHandle=this._requestAnimationFrame(t=>{this._draw(1),this._running=!0,this._lastFrameTimeMs=t,this._lastFpsUpdate=t,this._framesSinceLastFpsUpdate=0,this._rafHandle=this._requestAnimationFrame(this._animateBoundCall)})),this}stop(){return this._running=!1,this._started=!1,this._cancelAnimationFrame(this._rafHandle),this}_requestAnimationFrame(t){return this._hasWindow?window.requestAnimationFrame(t):this._timeoutAnimationFrame(t)}_timeoutAnimationFrame(t){let e=Date.now(),s=Math.max(0,this._simulationTimestep-(e-this._lastTimestampForTimeoutMethod));return this._lastTimestampForTimeoutMethod=e+s,setTimeout((function(){t(e+s)}),s)}_cancelAnimationFrame(t){this._hasWindow?cancelAnimationFrame(t):clearTimeout(t)}_animate(t){if(this._rafHandle=this._requestAnimationFrame(this._animateBoundCall),!(t<this._lastFrameTimeMs+this._minFrameDelay)){for(this._frameDelta+=t-this._lastFrameTimeMs,this._lastFrameTimeMs=t,this._begin(t,this._frameDelta),t>this._lastFpsUpdate+this._fpsUpdateInterval&&(this._fps=this._fpsAlpha*this._framesSinceLastFpsUpdate*1e3/(t-this._lastFpsUpdate)+(1-this._fpsAlpha)*this._fps,this._lastFpsUpdate=t,this._framesSinceLastFpsUpdate=0),this._framesSinceLastFpsUpdate++,this._numUpdateSteps=0;this._frameDelta>=this._simulationTimestep;)if(this._update(this._simulationTimestep),this._frameDelta-=this._simulationTimestep,++this._numUpdateSteps>=240){this._panic=!0;break}this._draw(this._frameDelta/this._simulationTimestep),this._end(this._fps,this._panic),this._panic=!1}}}class bt{constructor(t,e,s,i,n){this._created=!1,this._rootGameObject=t,this._inputDevices=e,this._timing=s,this._loader=i,this._environment=n}create(){if(this._created)throw new Error("Cannot create Game: already created");this._mainLoop=new Dt(this._begin.bind(this),this._update.bind(this),this._draw.bind(this),this._end.bind(this)),this._rootGameObject.doCreate(this._timing,this._loader,this._environment,this._inputDevices.inputDevices),this._created=!0}start(){if(!this._created)throw new Error("Cannot start Game: not yet created");this._mainLoop.start()}stop(){this._mainLoop.stop()}draw(){this._rootGameObject.doDraw(null)}_begin(t,e){this._timing.mainLoopTimestamp=t,this._timing.setDeltas(e),this._timing.updateSteps=this._mainLoop.numUpdateSteps,this._environment.checkFullscreenState(),this._rootGameObject.doBegin(this._timing,this._loader,this._environment,this._inputDevices.inputDevices),this._inputDevices.onBeginEnd()}_update(t){this._timing.setDeltas(t),this._rootGameObject.doUpdate(this._timing)}_draw(t){this._rootGameObject.doDraw(null)}_end(t,e){this._timing.fps=t,this._rootGameObject.doEnd(this._timing),e&&this._mainLoop.resetFrameDelta()}}class xt{constructor(){this.fps=0,this.updateSteps=0,this.mainLoopTimestamp=0,this.rawDelta=0,this.rawDeltaSeconds=0,this.delta=0,this.deltaSeconds=0,this.speedFactor=1}setDeltas(t){this.rawDelta=t,this.rawDeltaSeconds=t/1e3,1===this.speedFactor?(this.delta=t,this.deltaSeconds=this.rawDeltaSeconds):(this.delta=t*this.speedFactor,this.deltaSeconds=this.delta/1e3)}}class Tt{constructor(t,e,s){this._filename=t,this._asset=e,this._loaded=s}get filename(){return this._filename}get asset(){return this._asset}get loaded(){return this._loaded}set loaded(t){this._loaded=t}set(t){this._asset=t}}s(2);class kt{constructor(t){this._assetsFolder="./",this._sharedAssets=[],void 0!==t&&(this._assetsFolder=t)}get assetsFolder(){return this._assetsFolder}getSharedAsset(t){let e;for(let s=0,i=this._sharedAssets.length;s<i;s++)if(this._sharedAssets[s].filename===t){e=this._sharedAssets[s];break}if(e)return e;let s=new Tt(t,null,!1);return this._sharedAssets.push(s),s}loadImage(t,e){let s=new Image,i=new Tt(t,s,!1);return s.src=this.assetsFolder+t,s.onload=function(){i.loaded=!0,s.onload=null,s.onerror=null},s.onerror=()=>{s.onload=null,s.onerror=null,e(i)},i}loadFont(t,e,s,...i){return new Tt(t,e,!0)}}class Ct{constructor(){this._bufferSizes=10,this._keysDown=[],this._keysDownLength=0,this._keysUp=[],this._keysUpLength=0,this._keyPressesThisUpdate=[],this._keyPressesThisUpdateLength=0;for(let t=0,e=this._bufferSizes;t<e;t++)this._keysDown.push(null),this._keysUp.push(null),this._keyPressesThisUpdate.push(null)}get keyPressesThisUpdate(){return this._keyPressesThisUpdate}get keysDown(){return this._keysDown}get keysUp(){return this._keysUp}isKeyUp(t){for(let e=0,s=this._keysUpLength;e<s;e++)if(this._keysUp[e]===t)return!0;return!1}isKeyDown(t){for(let e=0,s=this._keysDownLength;e<s;e++)if(this._keysDown[e]===t)return!0;return!1}isKeyPressed(t){for(let e=0,s=this._keyPressesThisUpdateLength;e<s;e++)if(this._keyPressesThisUpdate[e]===t)return!0;return!1}keyPriority(t,e){let s=-1,i=-1;for(let n=0,a=this._keysDownLength;n<a&&!(this._keysDown[n]===t&&(s=n,i>-1))&&!(this._keysDown[n]===e&&(i=n,s>-1));n++);return s>i}onBeginEnd(){this._keyPressesThisUpdateLength=0;for(let t=0,e=this._keysUpLength;t<e;t++)for(let e=0,s=this._keysDownLength;e<s;e++)if(this._keysUp[t]===this._keysDown[e]){y(this._keysDown,e,this._keysDownLength-1),this._keysDownLength--;break}this._keysUpLength=0}keyDown(t){if(t.defaultPrevented)return;let e=!1;if(this._keysDownLength<this._bufferSizes)for(let s=0,i=this._keysDownLength;s<i;s++)if(this._keysDown[s]===t.key){e=!0;break}e||(this._keysDown[this._keysDownLength]=t.key,this._keysDownLength++)}keyUp(t){if(t.defaultPrevented)return;let e=!1;if(this._keysUpLength<this._bufferSizes)for(let s=0,i=this._keysUpLength;s<i;s++)if(this._keysUp[s]===t.key){e=!0;break}e||(this._keysUp[this._keysUpLength]=t.key,this._keysUpLength++)}keyPress(t){if(t.defaultPrevented)return;let e=!1;if(this._keyPressesThisUpdateLength<this._bufferSizes)for(let s=0,i=this._keyPressesThisUpdateLength;s<i;s++)if(this._keyPressesThisUpdate[s]===t.key){e=!0;break}e||(this._keyPressesThisUpdate[this._keyPressesThisUpdateLength]=t.key,this._keyPressesThisUpdateLength++)}}class Rt{constructor(t){this.x=0,this.y=0,this.isStartEvent=!1,this.isEndEvent=!1,this.isMoveEvent=!1,this.handled=!1,this.isDown=!1,this.id=t}}class St extends class{onBeginEnd(){}}{constructor(t,e){super(),this.pointers=[],this.wheelY=0,this.wheelEvent=!1,this.onClickAsync=new p,this.maxPointers=t;for(let e=0;e<t;e++)this.pointers.push(new Rt(e));this._htmlElementForOffset=e}get htmlElementForOffset(){return this._htmlElementForOffset}set htmlElementForOffset(t){this._htmlElementForOffset=t}handleAll(){for(let t=0,e=this.pointers.length;t<e;t++)this.pointers[t].handled=!0}onBeginEnd(){for(let t=0,e=this.pointers.length;t<e;t++)this.pointers[t].isStartEvent=!1,this.pointers[t].isEndEvent=!1,this.pointers[t].isMoveEvent=!1,this.pointers[t].handled=!1;this.wheelEvent=!1}mouseUp(t){this.pointers[0].isEndEvent=!0,this.pointers[0].isDown=!1,this.onClickAsync.call(this,this.pointers[0])}touchEnd(t){for(let e=1,s=t.changedTouches.length;e<s;e++)t.changedTouches[e].identifier+1<this.maxPointers&&(this.pointers[t.changedTouches[e].identifier+1].isEndEvent=!0,this.pointers[t.changedTouches[e].identifier+1].isDown=!1,this.pointers[t.changedTouches[e].identifier+1].x=t.changedTouches[e].pageX-this._htmlElementForOffset.offsetLeft,this.pointers[t.changedTouches[e].identifier+1].y=t.changedTouches[e].pageY-this._htmlElementForOffset.offsetTop,this.onClickAsync.length>0&&this.onClickAsync.call(this,this.pointers[t.changedTouches[e].identifier+1]))}mouseDown(t){this.pointers[0].isDown=!0,this.pointers[0].isStartEvent=!0,this.pointers[0].x=t.pageX-this._htmlElementForOffset.offsetLeft,this.pointers[0].y=t.pageY-this._htmlElementForOffset.offsetTop}touchStart(t){for(let e=0,s=t.changedTouches.length;e<s;e++)if(t.changedTouches[e].identifier+1<this.maxPointers){let s=this.pointers[t.changedTouches[e].identifier+1];s.isDown=!0,s.isEndEvent=!1,s.isMoveEvent=!1,s.handled=!1,s.isStartEvent=!0,s.x=t.changedTouches[e].pageX-this._htmlElementForOffset.offsetLeft,s.y=t.changedTouches[e].pageY-this._htmlElementForOffset.offsetTop}}mouseXY(t){this.pointers[0].isMoveEvent=!0,this.pointers[0].x=t.pageX-this._htmlElementForOffset.offsetLeft,this.pointers[0].y=t.pageY-this._htmlElementForOffset.offsetTop}touchXY(t){t.preventDefault();for(let e=0,s=t.changedTouches.length;e<s;e++)if(t.changedTouches[e].identifier+1<this.maxPointers){let s=this.pointers[t.changedTouches[e].identifier+1];s.isMoveEvent=!0,s.x=t.changedTouches[e].pageX-this._htmlElementForOffset.offsetLeft,s.y=t.changedTouches[e].pageY-this._htmlElementForOffset.offsetTop}}onWheelEvent(t){let e=t.deltaY;this.wheelY=0===e?0:e>0?1:-1,this.wheelEvent=!0}}class Mt{constructor(t,e,s,i,n){this.onFullscreenChange=new _,this.onResize=new m,this._isFullscreen=!1,this._devicePixelRatio=t,this._urlArgs=e,this._launcherOptions=i,this._document=n}get gameWidth(){return this._gameWidth}get gameHeight(){return this._gameHeight}get isFullscreen(){return this._isFullscreen}get devicePixelRatio(){return this._devicePixelRatio}get launcherOptions(){return this._launcherOptions}get urlArgs(){return this._urlArgs}get activeContainer(){return this._activeContainer}set activeContainer(t){this._activeContainer=t}setWidthAndHeight(t,e){this._gameWidth=t,this._gameHeight=e,this.onResize.call(t,e)}requestFullscreen(){return!!this._activeContainer&&(this._activeContainer.requestFullscreen(),!0)}exitFullscreen(){this._document.exitFullscreen()}createCanvas(){return this._document.createElement("canvas")}addCanvasToPage(t,e){e.appendChild(t)}checkFullscreenState(){let t=!1,e=null!=this._document.fullscreenElement;e!==this._isFullscreen&&(t=!0),this._isFullscreen=e,t&&this.onFullscreenChange.call(this._isFullscreen)}}let At={createTiming:function(){return new xt},createLoader:function(){return new kt},createKeyboard(t,e){let s=new Ct;return t.addEventListener("keydown",s.keyDown.bind(s),!0),t.addEventListener("keyup",s.keyUp.bind(s),!0),t.addEventListener("keypress",s.keyPress.bind(s),!0),s},createMouse:function(t,e){let s=new St(5,e);return t.body.addEventListener("mousedown",s.mouseDown.bind(s),!1),t.body.addEventListener("mousemove",s.mouseXY.bind(s),!1),t.body.addEventListener("touchstart",s.touchStart.bind(s),!1),t.body.addEventListener("touchmove",s.touchXY.bind(s),!0),t.body.addEventListener("touchend",s.touchEnd.bind(s),!1),t.body.addEventListener("mouseup",s.mouseUp.bind(s),!1),t.body.addEventListener("touchcancel",s.touchEnd.bind(s),!1),window.addEventListener("wheel",s.onWheelEvent.bind(s),!1),s},createEnvironment:function(t,e,s){let i=new Mt(window.devicePixelRatio,function(t){let e=[],s=new Map;return t.substr(1).split("&").forEach((function(t){e=t.split("="),s.set(decodeURIComponent(e[0]),decodeURIComponent(e[1]))})),s}(location.search),e,s,t);return window.addEventListener("resize",()=>i.setWidthAndHeight(e.offsetWidth,e.offsetHeight)),i},createRootGameObject:function(t,e,s){let i=new T(s.offsetWidth,s.offsetHeight),n=new e.rootGameObjectType(new w,new g(i));if(n.transform.bounds.minDimension=e.minDimension,n.transform.bounds.maxDimension=e.maxDimension,t.onResize.push((t,e)=>{i.width=t,i.height=e,n.transform.positioningIsDirty()}),n instanceof Y){let e=n.addCamera(n.addChild(new W(new w,g.fill)));e.hasAlphaChannel=t.launcherOptions.hasAlphaChannel,e.backgroundColor=t.launcherOptions.backgroundColor,e.container=s}return n}};let Et=[];Et=vt instanceof Array?vt:[vt],Et.forEach(t=>{let e=document.querySelector("#"+t.gameTarget);if(!e)throw new Error("Cannot create game canvas in HTMLElement with ID '"+t.gameTarget+"'. No element with that name was found.");let s=function(t,e,s,i){i||(i=At);let n=i.createEnvironment(e,s,t);s.style.userSelect="none";let a=new yt;if(t.usesKeyboard){let t=i.createKeyboard(e,s);a.addInputDevice(t,"keyboard")}if(t.usesMouse){let t=i.createMouse(e,s);a.addInputDevice(t,"mouse")}t.addExtraInputDevices(a);let r=i.createTiming(),o=i.createLoader(),h=i.createRootGameObject(n,t,s);return new bt(h,a,r,o,n)}(t,document,e);s.create(),s.start(),t.windowVariableName&&(window[t.windowVariableName]=s)})}]);